-- Tạo database
CREATE DATABASE QuanLyQuanCoffee
GO

USE QuanLyQuanCoffee
GO

-- Tạo table.
CREATE TABLE NHANVIEN
(
	MaNV NVARCHAR(50) PRIMARY KEY,
	HoTen NVARCHAR(50),
	GioiTinh NVARCHAR(50),
	DiaChi NVARCHAR(50),
	SDT NVARCHAR(50)
)
GO

CREATE TABLE KHACHHANG
(
	MaKH NVARCHAR(50) PRIMARY KEY,
	HoTen NVARCHAR(50),
	Phai NVARCHAR(50),
	SoDT NVARCHAR(50),
	MaLoaiKH NVARCHAR(50)
)
GO

CREATE TABLE LOAIKHACHHANG
(
	MaLoaiKH NVARCHAR(50) PRIMARY KEY,
	TenLoaiMKH NVARCHAR(50)
)
GO

CREATE TABLE SANPHAM
(
	MaSP NVARCHAR(50) PRIMARY KEY,
	TenSP NVARCHAR(50),
	Gia FLOAT,
	MaLoaiSP NVARCHAR(50),
)
GO

CREATE TABLE LOAISANPHAM
(
	MaLoaiSP NVARCHAR(50) PRIMARY KEY,
	TenLoai NVARCHAR(50)
)
GO

CREATE TABLE NGUYENLIEU
(
	MaNL NVARCHAR(50) PRIMARY KEY,
	TenNL NVARCHAR(50),
	MaLoaiNL NVARCHAR(50)
)
GO

CREATE TABLE LOAINGUYENLIEU
(
	MaLoaiNL NVARCHAR(50) PRIMARY KEY,
	TenLoaiNl NVARCHAR(50)
)
GO

CREATE TABLE BAN
(
	MaBan NVARCHAR(50) PRIMARY KEY,
	TenBan NVARCHAR(50),
	MaViTri NVARCHAR(50)
)
GO

CREATE TABLE CHONBAN
(
	MaBan NVARCHAR(50) PRIMARY KEY,
	ThoiDiem DATE,
	MaKH NVARCHAR(50),
	MaHD NVARCHAR(50)
)
GO

CREATE TABLE VITRI
(
	MaViTri NVARCHAR(50) PRIMARY KEY,
	Khu NVARCHAR(50)
)
GO

CREATE TABLE HOADON
(
	MaHD NVARCHAR(50) PRIMARY KEY,
	TongTien FLOAT,
	MaKH NVARCHAR(50),
	MaNV NVARCHAR(50),
	MaBan NVARCHAR(50)
)
GO

CREATE TABLE CHITIETHOADON
(
	MaPhieu NVARCHAR(50),
	MaSP NVARCHAR(50),
	SoLuong INT,
	ThanhTien FLOAT,
	MaHD NVARCHAR(50),
	PRIMARY KEY(MaSP,MaHD)
)
GO

-- Tạo khóa ngoại.
ALTER TABLE dbo.KHACHHANG ADD CONSTRAINT fk_khachhang_loaikhachhang FOREIGN KEY(MaLoaiKH) REFERENCES dbo.LOAIKHACHHANG(MaLoaiKH);
ALTER TABLE dbo.CHONBAN ADD CONSTRAINT fk_chonban_khachhang FOREIGN KEY(MaKH) REFERENCES dbo.KHACHHANG(MaKH);
ALTER TABLE dbo.BAN ADD CONSTRAINT fk_ban_chonban FOREIGN KEY(MaBan) REFERENCES dbo.CHONBAN(MaBan);
ALTER TABLE dbo.BAN ADD CONSTRAINT fk_ban_vitri FOREIGN KEY(MaViTri) REFERENCES dbo.VITRI(MaViTri);
ALTER TABLE dbo.SANPHAM ADD CONSTRAINT fk_sanpham_loaisanpham FOREIGN KEY(MaLoaiSP) REFERENCES dbo.LOAISANPHAM(MaLoaiSP);
ALTER TABLE dbo.NGUYENLIEU ADD CONSTRAINT fk_nguyenlieu_loainguyenlieu FOREIGN KEY(MaLoaiNL) REFERENCES dbo.LOAINGUYENLIEU(MaLoaiNL);
ALTER TABLE dbo.HOADON ADD CONSTRAINT fk_hoadon_nhanvien FOREIGN KEY(MaNV) REFERENCES dbo.NHANVIEN(MaNV);
ALTER TABLE dbo.CHITIETHOADON ADD CONSTRAINT fk_chitiethoadon_hoadon FOREIGN KEY(MaHD) REFERENCES dbo.HOADON(MaHD);
ALTER TABLE dbo.CHITIETHOADON ADD CONSTRAINT fk_chitiethoadon_sanpham FOREIGN KEY(MaSP) REFERENCES dbo.SANPHAM(MaSP);
ALTER TABLE dbo.NHANVIEN ADD CONSTRAINT fk_nhanvien_khachhang FOREIGN KEY(MaNV) REFERENCES dbo.KHACHHANG(MaKH);

-- khác.
ALTER TABLE dbo.NHANVIEN ADD Pass INT;
ALTER TABLE dbo.KHACHHANG DROP  COLUMN HoTen;
ALTER TABLE dbo.KHACHHANG DROP	COLUMN Phai;
ALTER TABLE dbo.KHACHHANG DROP COLUMN SoDT;


-- Thêm data (20 data).
-- Nhân viên.
